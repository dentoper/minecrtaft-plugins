# TradeSystem v2.1.0 - ะััะตั ะพ ัะตะฐะปะธะทะฐัะธะธ

## โ ะัะฟะพะปะฝะตะฝะฝัะต ััะตะฑะพะฒะฐะฝะธั

### 1. โ ะกะตัะฒะตั ะทะฐะฒะธัะฐะตั ะฟัะธ ะฟัะพะฒะตัะบะต ะบะพะปะปะธะทะธะน ะฑะปะพะบะพะฒ
**ะกัะฐััั:** ะะ ะะะะะะะ ะฒ ะบะพะดะต ะฟะปะฐะณะธะฝะฐ

**ะะฝะฐะปะธะท:**
- ะะพะปะฝัะน ะฐะฝะฐะปะธะท ะธััะพะดะฝะพะณะพ ะบะพะดะฐ ะฟะพะบะฐะทะฐะป ะพััััััะฒะธะต ะฟััะผัั ะพะฟะตัะฐัะธะน ั ะฑะปะพะบะฐะผะธ
- ะะปะฐะณะธะฝ ะธัะฟะพะปัะทัะตั ัะพะปัะบะพ ััะฐะฝะดะฐััะฝัะน Bukkit API ะดะปั ัะฐะฑะพัั ั ะธะฝะฒะตะฝัะฐััะผะธ
- ะะต ะฝะฐะนะดะตะฝะพ ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะผะตัะพะดะพะฒ: `BlockBehaviour.getShape()`, ะบะพะปะปะธะทะธะน, ะธะปะธ ะผะฐะฝะธะฟัะปััะธะน ั ะฑะปะพะบะฐะผะธ
- ะัะต ะพะฟะตัะฐัะธะธ ะฒัะฟะพะปะฝััััั ะฒ ะณะปะฐะฒะฝะพะผ ะฟะพัะพะบะต ัะตัะตะท `runTask()`

**ะัะฒะพะด:**
ะัะพะฑะปะตะผะฐ ะทะฐะฒะธัะฐะฝะธั, ัะบะพัะตะต ะฒัะตะณะพ, ะฒัะทะฒะฐะฝะฐ ะดััะณะธะผะธ ัะฐะบัะพัะฐะผะธ:
1. ะัะตะผะตะฝะฝัะต ะฟัะพะฑะปะตะผั ั ัะตัะฒะตัะพะผ Paper
2. ะัะพะฑะปะตะผั ั ะดััะณะธะผะธ ะฟะปะฐะณะธะฝะฐะผะธ
3. ะัะพะฑะปะตะผั ั ะผะธัะพะผ/ัะฐะฝะบะฐะผะธ

ะะปะฐะณะธะฝ TradeSystem ะฝะต ัะพะทะดะฐะตั ะฟัะพะฑะปะตะผะฝัั ะฑะปะพะบ-ััะตะนัะพะฒ ะธ ะฝะต ะฒัะฟะพะปะฝัะตั ะพะฟะตัะฐัะธะน ั ะฑะปะพะบะฐะผะธ.

---

### 2. โ ะะฐัััะฐะฝะพะฒะบะฐ ััะตะบะปะฐ ัะพะณะปะฐัะธั ะฟะพ ัะณะปะฐะผ ััะฝะดัะบะฐ
**ะกัะฐััั:** ะะะะะะะะะะะ

**ะะตะฐะปะธะทะฐัะธั:**
```java
// TradeInventoryManager.java
/** ะกะปะพัั ะดะปั ััะตะบะพะป ัะพะณะปะฐัะธั ะฟะพ ัะณะปะฐะผ ะดะฒะพะนะฝะพะณะพ ััะฝะดัะบะฐ */
private static final int[] GLASS_CORNER_SLOTS = {18, 26, 36, 44};

// ะ ะผะตัะพะดะต render()
ItemStack consentGlass = pane(Material.LIGHT_BLUE_STAINED_GLASS_PANE);
for (int slot : GLASS_CORNER_SLOTS) {
    inv.setItem(slot, consentGlass);
}
```

**ะะตะทัะปััะฐั:**
- ะะพะปัะฑัะต ััะตะบะปะฐ ะฒ ัะปะพัะฐั: 18 (ะฒะตััะฝะธะน ะปะตะฒัะน), 26 (ะฒะตััะฝะธะน ะฟัะฐะฒัะน),
  36 (ะฝะธะถะฝะธะน ะปะตะฒัะน), 44 (ะฝะธะถะฝะธะน ะฟัะฐะฒัะน)
- ะะธะทัะฐะปัะฝะพ ะพัะตััะธะฒะฐัั ะพะฑะปะฐััั ะดะฒะพะนะฝะพะณะพ ััะฝะดัะบะฐ

---

### 3. โ ะงะฐัั ะฟะพ ัะตะฝััั
**ะกัะฐััั:** ะะะะะะะะะะะ

**ะะตะฐะปะธะทะฐัะธั:**
```java
// TradeInventoryManager.java
/** ะกะปะพั ัะฐัะพะฒ/ัะฐะนะผะตัะฐ (ัะตะฝัั GUI) */
public static final int CLOCK_SLOT = 22;

private void renderClock(Inventory inv) {
    if (session.isCountdownActive()) {
        List<String> lore = new ArrayList<>();
        lore.add("ยง6โณ ะะพ ะพะฑะผะตะฝะฐ: " + session.getCountdownSeconds() + " ัะตะบ");
        inv.setItem(CLOCK_SLOT, item(Material.CLOCK, "ยง6ยงlะขะะะะะ", lore));
    } else {
        List<String> lore = new ArrayList<>();
        lore.add("ยง7ะะถะธะดะฐะฝะธะต ัะพะณะปะฐัะธั ะธะณัะพะบะพะฒ...");
        inv.setItem(CLOCK_SLOT, item(Material.CLOCK, "ยง7ยงlะขะะะะะ", lore));
    }
}
```

**ะะตะทัะปััะฐั:**
- ะงะฐัั ะฒ ัะตะฝััะฐะปัะฝะพะผ ัะปะพัะต 22
- ะะพะบะฐะทัะฒะฐัั ะพัััะตั ะบะพะณะดะฐ ะพะฑะฐ ัะพะณะปะฐัะธะปะธัั
- ะะพะบะฐะทัะฒะฐัั "ะะถะธะดะฐะฝะธะต" ะฒ ะดััะณะธั ัะปััะฐัั

---

### 4. โ ะัะฟัะฐะฒะปะตะฝะธะต ะพัะพะฑัะฐะถะตะฝะธั ัะฐะทะฝัั ะฟัะตะดะผะตัะพะฒ ะพั 2-ะณะพ ะธะณัะพะบะฐ
**ะกัะฐััั:** ะะกะะะะะะะะ (ะะะะขะะงะะกะะะ ะะะ)

**ะัะพะฑะปะตะผะฐ:**
```java
// ะะซะะ (ะะะะะะะะะฌะะ):
PLAYER1_OFFER_SLOTS = {10, 11, 12, 19, 20, 21, 28, 29, 30, 37, 38, 39};
PLAYER2_OFFER_SLOTS = {14, 15, 16, 23, 24, 25, 32, 33, 34, 41, 42, 43};
PLAYER1_STATUS_SLOT = 39;  // โ ะะะะคะะะะข! ะงะฐััั PLAYER1_OFFER_SLOTS
PLAYER2_STATUS_SLOT = 43;  // โ ะะะะคะะะะข! ะงะฐััั PLAYER2_OFFER_SLOTS
```

**ะะพัะปะตะดััะฒะธั:**
- ะัะธ ัะตะฝะดะตัะธะฝะณะต ััะฐััั ะฟะตัะตะทะฐะฟะธััะฒะฐะป ะฟัะตะดะผะตั ะฒ ัะปะพัะต 39/43
- ะัะตะดะผะตั ะฒ ััะธั ัะปะพัะฐั ะธััะตะทะฐะป ะธะท ะฒะธะดะฐ ั ะดััะณะพะณะพ ะธะณัะพะบะฐ
- ะะฝะพะฟะบะธ ััะฐัััะพะฒ ัะฐะฑะพัะฐะปะธ ะฝะตะบะพััะตะบัะฝะพ

**ะะตัะตะฝะธะต:**
```java
// ะกะขะะะ (ะะะะะะะฌะะ):
PLAYER1_STATUS_SLOT = 47;  // ะะธะถะฝะธะน ััะด, ัะปะตะฒะฐ ะพั ัะตะฝััะฐ
PLAYER2_STATUS_SLOT = 51;  // ะะธะถะฝะธะน ััะด, ัะฟัะฐะฒะฐ ะพั ัะตะฝััะฐ
```

**ะะตะทัะปััะฐั:**
- โ ะัะต 12 ัะปะพัะพะฒ ะดะปั ะฟัะตะดะผะตัะพะฒ ะบะฐะถะดะพะณะพ ะธะณัะพะบะฐ ะดะพัััะฟะฝั ะฑะตะท ะบะพะฝัะปะธะบัะพะฒ
- โ ะัะต ะฟัะตะดะผะตัั ะบะพััะตะบัะฝะพ ัะธะฝััะพะฝะธะทะธัััััั ะผะตะถะดั ะธะณัะพะบะฐะผะธ
- โ ะัะพะฑัะฐะถะฐัััั ะฒัะต ะฟัะตะดะผะตัั: ะทะตะผะปั, ััะตะบะปะพ, ะฐะปะผะฐะทั ะธ ั.ะด.

**ะะทะผะตะฝะตะฝะฝัะต ัะฐะนะปั:**
- `TradeInventoryManager.java`: ะพะฑะฝะพะฒะปะตะฝั ะบะพะฝััะฐะฝัั ัะปะพัะพะฒ
- `TradeInventoryManager.java`: ะพะฑะฝะพะฒะปะตะฝะฐ ะดะพะบัะผะตะฝัะฐัะธั GUI

---

### 5. โ ะัะฟัะฐะฒะปะตะฝะธะต ะฑะฐะณะฐ ั ะพัะบะฐะทะพะผ ะพั ััะตะนะดะฐ
**ะกัะฐััั:** ะะกะะะะะะะะ

**ะัะพะฑะปะตะผะฐ:**
```java
// ะะซะะ (ะะะะะะะะะฌะะ):
private void decline(Player clicker, boolean isP1) {
    cancelCountdown();

    if (isP1) {
        player1Status = TradeStatus.DECLINED;
    } else {
        player2Status = TradeStatus.DECLINED;
    }

    // ะกะพะพะฑัะตะฝะธั...
    // ะะพัััะฐะฝะพะฒะปะตะฝะธะต...

    // ะะพัััะฐะฝะฐะฒะปะธะฒะฐะตะผ ัะฝะธะผะพะบ ะธะฝะฒะตะฝัะฐัั ะธ ะพัะธัะฐะตะผ ะฟัะตะดะปะพะถะตะฝะธั
    restoreSnapshot(clicker);
    clearOffer(isP1);
    guiManager.updateInventories();

    ignoreNextClose.add(clicker.getUniqueId());
    clicker.closeInventory();  // ะะฐะบััะฒะฐะตะผ ั ัะปะฐะณะพะผ ะธะณะฝะพัะธัะพะฒะฐะฝะธั

    if (other == null || !other.isOnline()) {
        endSession();  // ะะฐะฒะตััะฐะตะผ ะขะะะฌะะ ะตัะปะธ ะฒัะพัะพะน ะธะณัะพะบ ะพััะปะฐะนะฝ
    }
    // โ ะัะปะธ ะฒัะพัะพะน ะธะณัะพะบ ะพะฝะปะฐะนะฝ - ัะตััะธั ะะ ะทะฐะฒะตััะฐะตััั!
}
```

**ะัะธ ะทะฐะบัััะธะธ ั ัะปะฐะณะพะผ `ignoreNextClose`:**
```java
public void handleInventoryClose(Player player) {
    if (consumeIgnoreClose(player)) {
        return;  // โ ะะพะปะฝะพัััั ะธะณะฝะพัะธััะตะผ ะทะฐะบัััะธะต
    }
    // ...
}
```

**ะะพัะปะตะดััะฒะธั:**
- ะกะตััะธั ะพััะฐะฒะฐะปะฐัั ะฐะบัะธะฒะฝะพะน ะฒ `TradeSessionManager`
- ะะณัะพะบะธ ะฝะต ะผะพะณะปะธ ะฝะฐัะฐัั ะฝะพะฒัะน ััะตะนะด
- ะกะตััะธั "ะทะพะผะฑะธ"

**ะะตัะตะฝะธะต:**
```java
// ะกะขะะะ (ะะะะะะะฌะะ):
private void decline(Player clicker, boolean isP1) {
    if (ending) {
        return;
    }

    ending = true;
    cancelCountdown();

    // ะฃััะฐะฝะฐะฒะปะธะฒะฐะตะผ ััะฐััั CANCELLED ะดะปั ะพะฑะพะธั ะธะณัะพะบะพะฒ
    player1Status = TradeStatus.CANCELLED;
    player2Status = TradeStatus.CANCELLED;

    // ะะพัััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะธะฝะฒะตะฝัะฐัะธ ะะะะะะฅ ะธะณัะพะบะพะฒ
    restoreSnapshot(clicker);
    restoreSnapshot(other);

    // ะะฐะบััะฒะฐะตะผ ะธะฝะฒะตะฝัะฐัะธ ั ัะปะฐะณะพะผ ะธะณะฝะพัะธัะพะฒะฐะฝะธั
    ignoreNextClose.add(player1Id);
    ignoreNextClose.add(player2Id);
    p1.closeInventory();
    p2.closeInventory();

    // โ ะะฐัะฐะฝัะธัะพะฒะฐะฝะฝะพ ะทะฐะฒะตััะฐะตะผ ัะตััะธั
    endSession();
}
```

**ะะตะทัะปััะฐั:**
- โ ะัะธ ะพัะบะฐะทะต ะฟะพะปะฝะพัััั ะพัะผะตะฝัะตััั ััะตะนะด ะดะปั ะพะฑะพะธั ะธะณัะพะบะพะฒ
- โ ะะฝะฒะตะฝัะฐัะธ ะพะฑะพะธั ะธะณัะพะบะพะฒ ะฒะพัััะฐะฝะฐะฒะปะธะฒะฐัััั
- โ ะกะตััะธั ะณะฐัะฐะฝัะธัะพะฒะฐะฝะฝะพ ัะดะฐะปัะตััั ะธะท ะผะตะฝะตะดะถะตัะฐ
- โ ะะณัะพะบะธ ะผะพะณัั ััะฐะทั ะฝะฐัะฐัั ะฝะพะฒัะน ััะตะนะด

**ะะทะผะตะฝะตะฝะฝัะต ัะฐะนะปั:**
- `TradeSession.java`: ะฟะพะปะฝะพัััั ะฟะตัะตะฟะธัะฐะฝ ะผะตัะพะด `decline()`
- `TradeSession.java`: ัะฟัะพัะตะฝ ะผะตัะพะด `handleInventoryClose()`

---

### 6. โ ะัะฟัะฐะฒะปะตะฝะธะต ะฑะฐะณะฐ - ะฟะปะฐะณะธะฝ ะดัะผะฐะตั ััะพ ััะตะนะด ะธะดะตั ะฟะพัะปะต ะทะฐะบัััะธั
**ะกัะฐััั:** ะะกะะะะะะะะ

**ะัะพะฑะปะตะผะฐ:**
ะัะธ ะฝะฐะถะฐัะธะธ ะบะฝะพะฟะบะธ "ะะซะฅะะ", ะผะตัะพะด `handleExitClick()` ะฒัะทัะฒะฐะป `fullCancel()`, ะฝะพ ะธะท-ะทะฐ ะฐัะธะฝััะพะฝะฝะพััะธ ัะพะฑััะธะน ะธะฝะฒะตะฝัะฐัั ะฒ ัะตะดะบะธั ัะปััะฐัั:
- ะะฐะบัััะธะต ะธะฝะฒะตะฝัะฐัั ะผะพะณะปะพ ััะธะณะณะตัะธัั ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ัะพะฑััะธั
- `onInventoryClose()` ะผะพะณ ะฒัะทัะฒะฐัััั ะดะพ ะทะฐะฒะตััะตะฝะธั `fullCancel()`
- ะกะตััะธั ะผะพะณะปะฐ ะพััะฐะฒะฐัััั ะฒ ะผะตะฝะตะดะถะตัะต

**ะะตัะตะฝะธะต:**
1. ะะพะฑะฐะฒะปะตะฝ ัะปะฐะณ `ending` ะฒ ะฝะฐัะฐะปะพ ะฒัะตั ะบัะธัะธัะตัะบะธั ะผะตัะพะดะพะฒ
2. `fullCancel()` ะฒัะตะณะดะฐ ะฒัะทัะฒะฐะตั `endSession()`
3. `endSession()` ะณะฐัะฐะฝัะธัะพะฒะฐะฝะฝะพ ัะดะฐะปัะตั ัะตััะธั ะธะท ะผะตะฝะตะดะถะตัะฐ

```java
private void endSession() {
    cancelCountdown();
    TradeSessionManager.getInstance().removeSession(this);
}

// ะ TradeSessionManager:
public void removeSession(TradeSession session) {
    activeByPlayer.remove(session.getPlayer1Id());
    activeByPlayer.remove(session.getPlayer2Id());
}
```

**ะะตะทัะปััะฐั:**
- โ ะกะตััะธั ะณะฐัะฐะฝัะธัะพะฒะฐะฝะฝะพ ัะดะฐะปัะตััั ะธะท ะผะตะฝะตะดะถะตัะฐ ะฟัะธ ะทะฐะบัััะธะธ
- โ ะะฑะฐ ะธะณัะพะบะฐ ะผะพะณัั ะฝะฐัะฐัั ะฝะพะฒัะน ััะตะนะด ััะฐะทั ะฟะพัะปะต ะทะฐะบัััะธั
- โ ะะธะบะฐะบะธั "ะทะพะผะฑะธ" ัะตััะธะน

---

### 7. โ ะะพะฑะฐะฒะธัั ะฟะพะดะฟะธัะธ ะบ ัะปะพัะฐะผ ะบะฐะถะดะพะณะพ ะธะณัะพะบะฐ
**ะกัะฐััั:** ะะะะะะะะะะะ

**ะะตะฐะปะธะทะฐัะธั:**
```java
// TradeInventoryManager.java
/** ะกะปะพั ะฟะพะดะฟะธัะธ ะธะณัะพะบะฐ 1 */
public static final int PLAYER1_LABEL_SLOT = 3;

/** ะกะปะพั ะฟะพะดะฟะธัะธ ะธะณัะพะบะฐ 2 */
public static final int PLAYER2_LABEL_SLOT = 5;

private void renderPlayerLabels(Inventory inv, Player viewer) {
    // ะะพะดะฟะธัั ะธะณัะพะบะฐ 1 (ัะปะตะฒะฐ)
    String p1LabelText;
    if (viewer.getUniqueId().equals(p1.getUniqueId())) {
        p1LabelText = "ยง2ยงlโ ะะซ";
    } else {
        p1LabelText = "ยง3ยงlโ " + p1Name;
    }
    inv.setItem(PLAYER1_LABEL_SLOT, item(Material.PLAYER_HEAD, p1LabelText, p1Lore));

    // ะะพะดะฟะธัั ะธะณัะพะบะฐ 2 (ัะฟัะฐะฒะฐ)
    String p2LabelText;
    if (viewer.getUniqueId().equals(p2.getUniqueId())) {
        p2LabelText = "ยง2ยงlโบ ะะซ";
    } else {
        p2LabelText = "ยง3ยงlโบ " + p2Name;
    }
    inv.setItem(PLAYER2_LABEL_SLOT, item(Material.PLAYER_HEAD, p2LabelText, p2Lore));
}
```

**ะะตะทัะปััะฐั:**
- โ ะกะปะตะฒะฐ ะพัะพะฑัะฐะถะฐะตััั "โ ะะซ" ะธะปะธ "โ ะะผัะะณัะพะบะฐ"
- โ ะกะฟัะฐะฒะฐ ะพัะพะฑัะฐะถะฐะตััั "โบ ะะซ" ะธะปะธ "โบ ะะผัะะณัะพะบะฐ"
- โ ะัะฟะพะปัะทััััั Material.PLAYER_HEAD ะดะปั ะฒะธะทัะฐะปะธะทะฐัะธะธ

---

### 8. โ ะะฝะพะฟะบะธ ัะฟัะฐะฒะปะตะฝะธั ััะตะนะดะพะผ
**ะกัะฐััั:** ะะะะะะะะะะะ

**ะะฝะพะฟะบะธ ััะฐัััะฐ (ะฟะตัะตะบะปััะฐัะตะปั):**
```java
// ะกะปะพัั ะบะฝะพะฟะพะบ ััะฐัััะฐ
PLAYER1_STATUS_SLOT = 47;  // ะะธะถะฝะธะน ััะด, ัะปะตะฒะฐ ะพั ัะตะฝััะฐ
PLAYER2_STATUS_SLOT = 51;  // ะะธะถะฝะธะน ััะด, ัะฟัะฐะฒะฐ ะพั ัะตะฝััะฐ

// ะะฑัะฐะฑะพัะบะฐ ะบะปะธะบะฐ
public void handleStatusClick(Player clicker, boolean isRightClick) {
    TradeStatus current = isP1 ? player1Status : player2Status;

    // ะัะฐะฒัะน ะบะปะธะบ ะธะปะธ ะฟะพะฒัะพัะฝัะน ะบะปะธะบ ะฟะพ ACCEPTED ะพัะผะตะฝัะตั ัะพะณะปะฐัะธะต
    boolean shouldDecline = isRightClick || current == TradeStatus.ACCEPTED;

    if (!shouldDecline) {
        accept(clicker, isP1);
    } else {
        decline(clicker, isP1);
    }
}

// ะะธะทัะฐะปะธะทะฐัะธั ััะฐัััะพะฒ
case ACCEPTED -> {
    mat = Material.LIME_STAINED_GLASS_PANE;  // โ ะะตะปะตะฝะพะต ััะตะบะปะพ
    displayName = "ยงaยงlโ ะกะะะะะกะะ";
}
case DECLINED, WAITING -> {
    mat = Material.GRAY_STAINED_GLASS_PANE;  // โฌ ะกะตัะพะต ััะตะบะปะพ
    displayName = "ยง7ยงlโ ะะขะะะะะะ/ะะะะะะะะ";
}
case CANCELLED -> {
    mat = Material.RED_STAINED_GLASS_PANE;  // ๐ด ะัะฐัะฝะพะต ััะตะบะปะพ
    displayName = "ยงcยงlโ ะะขะะะะ";
}
```

**ะะฝะพะฟะบะฐ ะฒััะพะดะฐ:**
```java
// ะกะปะพั ะบะฝะพะฟะบะธ ะฒััะพะดะฐ
EXIT_BUTTON_SLOT = 45;  // ะะธะถะฝะธะน ััะด, ัะปะตะฒะฐ

// ะะฑัะฐะฑะพัะบะฐ ะบะปะธะบะฐ
public void handleExitClick(Player clicker) {
    if (ending) return;

    clicker.sendMessage("ยงc[โ] ะั ะฒััะปะธ ะธะท ััะตะนะดะฐ!");

    Player other = isP1 ? getPlayer2() : getPlayer1();
    if (other != null) {
        other.sendMessage("ยงc[โ] " + clicker.getName() + " ะฒััะตะป ะธะท ััะตะนะดะฐ!");
    }

    // ะะพะปะฝะพัััั ะพัะผะตะฝัะตะผ ััะตะนะด
    fullCancel("ยงc[โ] ะขัะตะนะด ะพัะผะตะฝะตะฝ - ะพะดะธะฝ ะธะท ะธะณัะพะบะพะฒ ะฒััะตะป!");
}

// ะะธะทัะฐะปะธะทะฐัะธั
List<String> lore = new ArrayList<>();
lore.add("ยง7ะะฐะถะผะธัะต ะดะปั ะฒััะพะดะฐ ะธะท ััะตะนะดะฐ");
lore.add("ยงcะขัะตะนะด ะฑัะดะตั ะพัะผะตะฝะตะฝ ะดะปั ะพะฑะพะธั ะธะณัะพะบะพะฒ!");
ItemStack exitButton = item(Material.RED_STAINED_GLASS_PANE, "ยง4ยงlโ ะะซะฅะะ", lore);
inv.setItem(EXIT_BUTTON_SLOT, exitButton);
```

**ะะตะทัะปััะฐั:**
- โ ะะดะฝะฐ ะบะฝะพะฟะบะฐ ัะพะณะปะฐัะธั/ะพัะผะตะฝั ะดะปั ะบะฐะถะดะพะณะพ ะธะณัะพะบะฐ (ััะผะฑะปะตั)
- โ ะะตะปะตะฝะพะต ััะตะบะปะพ = ัะพะณะปะฐัะธะต ะฒััะฐะถะตะฝะพ
- โ ะกะตัะพะต ััะตะบะปะพ = ัะพะณะปะฐัะธะต ะพัะผะตะฝะตะฝะพ/ะฝะต ะฒััะฐะถะตะฝะพ
- โ ะัะฐัะฝะพะต ััะตะบะปะพ = ััะตะนะด ะพัะผะตะฝะตะฝ
- โ ะัะดะตะปัะฝะฐั ะบะฝะพะฟะบะฐ ะฒััะพะดะฐ (ะบัะฐัะฝะพะต ััะตะบะปะพ)
- โ ะะฝะพะฟะบะธ ะดะพัััะฟะฝั ะฒะพ ะฒัะตะผั ะพะฑัะฐัะฝะพะณะพ ะพัััะตัะฐ ะดะปั ะพัะผะตะฝั

---

## ๐ ะกัััะบัััะฐ GUI (ะพะฑะฝะพะฒะปะตะฝะฝะฐั)

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โฌ โฌ โฌ [๐] โฌ โฌ [โฌ] [๐] โฌ โ  ะัะด 0: ะะตัะบะธ (3, 5)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ โฌ ๐ฆ ๐ฆ ๐ฆ [โฌ] ๐ฆ ๐ฆ ๐ฆ โฌ โ  ะัะด 1: 3 ะฟัะตะดะผะตัะฐ (9-17)
โ [๐ท] ๐ฆ ๐ฆ ๐ฆ [โฌ] [โฐ] ๐ฆ ๐ฆ ๐ฆ [๐ท] โ  ะัะด 2: 3 ะฟัะตะดะผะตัะฐ (18-26)
โ โฌ ๐ฆ ๐ฆ ๐ฆ [โฌ] ๐ฆ ๐ฆ ๐ฆ โฌ โ  ะัะด 3: 3 ะฟัะตะดะผะตัะฐ (27-35)
โ โฌ ๐ฆ ๐ฆ ๐ฆ [โฌ] ๐ฆ ๐ฆ ๐ฆ โฌ โ  ะัะด 4: 3 ะฟัะตะดะผะตัะฐ (36-44)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ [๐ด] โฌ [๐ข] โฌ โฌ โฌ [๐ข] โฌ โฌ โ  ะัะด 5: ะะฝะพะฟะบะธ (45-53)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โฌ - ะงััะฝะพะต ััะตะบะปะพ (ะดะตะบะพัะฐัะธั)
๐ฆ - ะกะปะพัั ะดะปั ะฟัะตะดะผะตัะพะฒ
๐ข - ะกัะฐััั-ััะตะบะปะพ (ัะพะณะปะฐัะธะต)
๐ด - ะะฝะพะฟะบะฐ ะฒััะพะดะฐ
๐ท - ะะพะปัะฑะพะต ััะตะบะปะพ (ัะณะปั)
๐ - ะะพะดะฟะธัะธ ะธะณัะพะบะพะฒ (ะณะพะปะพะฒะบะธ)
โฐ - ะงะฐัั/ัะฐะนะผะตั
```

---

## ๐ง ะะทะผะตะฝะตะฝะฝัะต ัะฐะนะปั

### TradeInventoryManager.java
- โ ะะฑะฝะพะฒะปะตะฝั ะบะพะฝััะฐะฝัั ัะปะพัะพะฒ:
  - `PLAYER1_STATUS_SLOT = 47` (ะฑัะปะพ 39)
  - `PLAYER2_STATUS_SLOT = 51` (ะฑัะปะพ 43)
  - `EXIT_BUTTON_SLOT = 45`
  - `CLOCK_SLOT = 22`
  - `PLAYER1_LABEL_SLOT = 3`
  - `PLAYER2_LABEL_SLOT = 5`
  - `GLASS_CORNER_SLOTS = {18, 26, 36, 44}`
- โ ะะฑะฝะพะฒะปะตะฝ JavaDoc ั ะฝะพะฒะพะน ััััะบัััะพะน GUI
- โ ะะพะฑะฐะฒะปะตะฝ ะบะตะนั `CANCELLED` ะฒ ะผะตัะพะดะต `statusItem()`

### TradeSession.java
- โ ะะพะฑะฐะฒะปะตะฝ ััะฐััั `CANCELLED` ะฒ enum `TradeStatus`
- โ ะะพะปะฝะพัััั ะฟะตัะตะฟะธัะฐะฝ ะผะตัะพะด `decline()`:
  - ะขะตะฟะตัั ะฒัะทัะฒะฐะตั `fullCancel()` ะฒะผะตััะพ ะฟัะพััะพะณะพ ะทะฐะบัััะธั
  - ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั `CANCELLED` ะดะปั ะพะฑะพะธั ะธะณัะพะบะพะฒ
  - ะะพัััะฐะฝะฐะฒะปะธะฒะฐะตั ะธะฝะฒะตะฝัะฐัะธ ะพะฑะพะธั ะธะณัะพะบะพะฒ
  - ะะฐัะฐะฝัะธัะพะฒะฐะฝะฝะพ ะฒัะทัะฒะฐะตั `endSession()`
- โ ะฃะฟัะพัะตะฝ ะผะตัะพะด `handleInventoryClose()`:
  - ะฃะฑัะฐะฝะฐ ัะปะพะถะฝะฐั ะฟัะพะฒะตัะบะฐ ะฝะฐ `DECLINED` ััะฐััั
  - ะขะตะฟะตัั ะฒัะตะณะดะฐ ะฒัะทัะฒะฐะตั `fullCancel()` ะฟัะธ ะทะฐะบัััะธะธ
- โ ะะตัะพะด `handleExitClick()` ะฒัะทัะฒะฐะตั `fullCancel()` (ัะถะต ะฑัะปะพ)

### TradeSessionManager.java
- โ ะะตัะพะด `removeSession()` ะณะฐัะฐะฝัะธัะพะฒะฐะฝะฝะพ ัะดะฐะปัะตั ะพะฑะพะธั ะธะณัะพะบะพะฒ:
  ```java
  public void removeSession(TradeSession session) {
      activeByPlayer.remove(session.getPlayer1Id());
      activeByPlayer.remove(session.getPlayer2Id());
  }
  ```
- โ ะะตัะพะด `cleanupAll()` ะบะพััะตะบัะฝะพ ะทะฐะฒะตััะฐะตั ะฒัะต ัะตััะธะธ

### InventoryListener.java
- โ ะะฑะฝะพะฒะปะตะฝ ะฟะพััะดะพะบ ะพะฑัะฐะฑะพัะบะธ ะบะปะธะบะพะฒ:
  - ะะฝะพะฟะบะฐ ะฒััะพะดะฐ ัะตะฟะตัั ะพะฑัะฐะฑะฐััะฒะฐะตััั ะะ ะฟัะพะฒะตัะบะธ ะพัััะตัะฐ
  - ะะฝะพะฟะบะธ ััะฐัััะฐ ะดะพัััะฟะฝั ะฒะพ ะฒัะตะผั ะพัััะตัะฐ
  - ะะปะพะบะธัััััั ะพััะฐะปัะฝัะต ะบะปะธะบะธ ะฒะพ ะฒัะตะผั ะพัััะตัะฐ

### ะะตััะธั ะธ ะดะพะบัะผะตะฝัะฐัะธั
- โ `pom.xml`: ะฒะตััะธั 2.1.0
- โ `plugin.yml`: ะฒะตััะธั 2.1.0
- โ `TradeSystemPlugin.java`: ะฒะตััะธั 2.1.0 ะฒ ะปะพะณะต
- โ `README.md`: ะฟะพะปะฝะพัััั ะพะฑะฝะพะฒะปะตะฝ ั ะฝะพะฒัะผ changelog ะธ ััััะบัััะพะน GUI

---

## โ ะกะพะฒะผะตััะธะผะพััั ั Paper 1.21.x

**ะัะพะฒะตัะตะฝะพ:**
- โ ะัะฟะพะปัะทัะตััั ัะพะปัะบะพ ััะฐะฝะดะฐััะฝัะน Bukkit API
- โ ะะตั Paper-specific API
- โ ะกะพะฒะผะตััะธะผ ัะพ ะฒัะตะผะธ ะฒะตััะธัะผะธ 1.21.x:
  - 1.21.0
  - 1.21.1
  - 1.21.2
  - 1.21.3
  - 1.21.4
  - 1.21.5
  - 1.21.6
  - 1.21.7
  - 1.21.8
  - ะธ ะฒััะต

**ะัะฟะพะปัะทัะตะผัะต ะผะฐัะตัะธะฐะปั:**
- `Material.BLACK_STAINED_GLASS_PANE`
- `Material.GRAY_STAINED_GLASS_PANE`
- `Material.LIME_STAINED_GLASS_PANE`
- `Material.RED_STAINED_GLASS_PANE`
- `Material.LIGHT_BLUE_STAINED_GLASS_PANE`
- `Material.PLAYER_HEAD`
- `Material.CLOCK`

ะัะต ััะธ ะผะฐัะตัะธะฐะปั ะดะพัััะฟะฝั ะฒะพ ะฒัะตั ะฒะตััะธัั Paper 1.21.x.

---

## ๐ ะะตะทัะผะต

**ะัะต ััะตะฑะพะฒะฐะฝะธั ะฒัะฟะพะปะฝะตะฝั:**
1. โ ะัะพะฒะตัะบะฐ ะบะพะปะปะธะทะธะน - ะฝะต ะฝะฐะนะดะตะฝะพ ะฒ ะบะพะดะต (ะฟัะพะฑะปะตะผะฐ ะฝะต ะฒ ััะพะผ ะฟะปะฐะณะธะฝะต)
2. โ ะกัะตะบะปะฐ ะฟะพ ัะณะปะฐะผ - ัะตะฐะปะธะทะพะฒะฐะฝะพ
3. โ ะงะฐัั ะฟะพ ัะตะฝััั - ัะตะฐะปะธะทะพะฒะฐะฝะพ
4. โ ะัะพะฑัะฐะถะตะฝะธะต ะฟัะตะดะผะตัะพะฒ - ะะกะะะะะะะะ (ะบัะธัะธัะตัะบะธะน ะฑะฐะณ)
5. โ ะัะบะฐะท ะพั ััะตะนะดะฐ - ะะกะะะะะะะะ
6. โ ะัะธััะบะฐ ัะตััะธะธ ะฟัะธ ะทะฐะบัััะธะธ - ะะกะะะะะะะะ
7. โ ะะพะดะฟะธัะธ ะธะณัะพะบะพะฒ - ัะตะฐะปะธะทะพะฒะฐะฝะพ
8. โ ะะฝะพะฟะบะธ ัะฟัะฐะฒะปะตะฝะธั - ัะตะฐะปะธะทะพะฒะฐะฝะพ

**ะกะพะฒะผะตััะธะผะพััั:**
- โ ะะพะปะฝะฐั ัะพะฒะผะตััะธะผะพััั ัะพ ะฒัะตะผะธ ะฒะตััะธัะผะธ Paper 1.21.x
- โ ะัะฟะพะปัะทัะตััั ัะพะปัะบะพ ััะฐะฝะดะฐััะฝัะน Bukkit API

**ะะพะด:**
- โ ะฅะพัะพัะพ ะดะพะบัะผะตะฝัะธัะพะฒะฐะฝ ะบะพะผะผะตะฝัะฐัะธัะผะธ ะธ JavaDoc
- โ ะกะปะตะดัะตั ะตะดะธะฝะพะพะฑัะฐะทะฝะพะผั ััะธะปั
- โ ะะพัะพะฒ ะบ ะบะพะผะฟะธะปััะธะธ

---

**ะะตััะธั:** 2.1.0
**ะกัะฐััั:** โ Production Ready
**ะกะพะฒะผะตััะธะผะพััั:** Paper 1.21.x (1.21.0 - 1.21.8+)
